@import url("https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&family=Pragati+Narrow:wght@400;700&display=swap");

/* Dockview core styles */
@import "dockview-core/dist/styles/dockview.css";

@import "tw-animate-css";

@theme {
  /* Fonts - literal values, no var() references */
  --font-plus-jakarta-sans: "Plus Jakarta Sans";
  --font-inter: "Inter";
  --font-pragati-narrow: "Pragati Narrow";
  --font-fira-code: "Fira Code";

  /* Basic colors */
  --color-dark-surface: #262626;

  /* Semantic colors */
  --color-background-primary: var(--color-dark-surface);

  --color-text-primary: #f1f1f1;
  --color-text-secondary: #bfbfbf;
}

@theme inline {
  /* Spacing - topbar and safe area (dynamic references) */
  --spacing-topbar: var(--topbar-height);
  --spacing-safe-top: var(--safe-area-inset-top);
  --spacing-safe-bottom: var(--safe-area-inset-bottom);
  --spacing-safe-left: var(--safe-area-inset-left);
  --spacing-safe-right: var(--safe-area-inset-right);

  /* Inset/Position utilities */
  --inset-topbar: var(--topbar-height);

  /* Core colors - shadcn/ui compatible (kept for remaining usages) */
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);

  /* Sidebar colors */
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  /* Background colors */
  --color-background-card: var(--background-card);
  --color-background-container: var(--background-container);
  --color-background-input: var(--background-input);
  --color-background-screen: var(--background-screen);

  /* Border colors */
  --color-border-dark: var(--border-dark);
  --color-border-normal: var(--border-normal);
  --color-border-selected-inverse: var(--border-selected-inverse);
  --color-border-divider: var(--border-divider);
  --color-border-container: var(--border-container);

  /* Button colors */
  --color-button-background-primary: var(--button-background-primary);
  --color-button-foreground-primary: var(--button-foreground-primary);
  --color-button-foreground-disabled: var(--button-foreground-disabled);
  --color-button-background-secondary: var(--button-background-secondary);
  --color-button-foreground-secondary: var(--button-foreground-secondary);
  --color-button-background-floating: var(--button-background-floating);
  --color-button-chips: var(--button-chips);

  /* Secondary colors */
  --color-secondary-normal: var(--secondary-normal);

  /* Status colors */
  --color-status-optional: var(--status-optional);
  --color-status-required: var(--status-required);
  --color-status-ready: var(--status-ready);
  --color-status-warning-light: var(--status-warning-light);
}

:root {
  /* Topbar height for layout calculations */
  --topbar-height: 38px; /* Default for Electron environment */

  --background: hsl(0 0% 3.9%);
  --foreground: hsl(0 0% 98%);
  --card: hsl(0 0% 3.9%);
  --card-foreground: hsl(0 0% 98%);
  --popover: hsl(0 0% 3.9%);
  --popover-foreground: hsl(0 0% 98%);
  --primary: hsl(0 0% 98%);
  --primary-foreground: hsl(0 0% 9%);
  --secondary: hsl(0 0% 14.9%);
  --secondary-foreground: hsl(0 0% 98%);
  --muted: hsl(0 0% 14.9%);
  --muted-foreground: hsl(0 0% 63.9%);
  --accent: hsl(0 0% 14.9%);
  --accent-foreground: hsl(0 0% 98%);
  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(0 0% 14.9%);
  --input: hsl(0 0% 14.9%);
  --ring: hsl(0 0% 83.1%);
  --sidebar-background: hsl(240 5.9% 10%);
  --sidebar-foreground: hsl(240 4.8% 95.9%);
  --sidebar-primary: hsl(224.3 76.3% 48%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(240 3.7% 15.9%);
  --sidebar-accent-foreground: hsl(240 4.8% 95.9%);
  --sidebar-border: hsl(240 3.7% 15.9%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);

  /* Existing background colors */
  --background-card: #37404c;
  --background-container: #2a313a;
  --background-input: #475263;
  --background-screen: #111111;

  /* Existing border colors */
  --border-container: #64748b;
  --border-divider: #37404c;

  /* New border colors */
  --border-dark: #313131;
  --border-normal: #525252;
  --border-black: #1b1b1b;
  --border-selected-inverse: #f1f1f1;

  /* Existing button colors */
  --button-background-primary: #98d7f9;
  --button-foreground-primary: #0d4766;
  --button-foreground-disabled: #757575;
  --button-background-secondary: #b59eff;
  --button-foreground-secondary: #27136b;

  /* New button colors */
  --button-background-floating: #313131;
  --button-chips: #414141;

  /* Existing text colors (kept for CSS variable references in base styles) */
  --text-muted-title: #d4d4d4;
  --text-user-message: #3f3f3f;

  /* Existing secondary colors */
  --secondary-normal: #b59eff;

  /* Status colors */
  --status-optional: #a1ece7;
  --status-required: #b59eff;
  --status-warning-light: #a16207;
  --status-ready: #0d9488;

  /* iOS Safe Area Variables */
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
}

.dark {
  --background: hsl(0 0% 3.9%);
  --foreground: hsl(0 0% 98%);
  --card: hsl(0 0% 3.9%);
  --card-foreground: hsl(0 0% 98%);
  --popover: hsl(0 0% 3.9%);
  --popover-foreground: hsl(0 0% 98%);
  --primary: hsl(0 0% 98%);
  --primary-foreground: hsl(0 0% 9%);
  --secondary: hsl(0 0% 14.9%);
  --secondary-foreground: hsl(0 0% 98%);
  --muted: hsl(0 0% 14.9%);
  --muted-foreground: hsl(0 0% 63.9%);
  --accent: hsl(0 0% 14.9%);
  --accent-foreground: hsl(0 0% 98%);
  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(0 0% 14.9%);
  --input: hsl(0 0% 14.9%);
  --ring: hsl(0 0% 83.1%);
  --sidebar-background: hsl(240 5.9% 10%);
  --sidebar-foreground: hsl(240 4.8% 95.9%);
  --sidebar-primary: hsl(224.3 76.3% 48%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(240 3.7% 15.9%);
  --sidebar-accent-foreground: hsl(240 4.8% 95.9%);
  --sidebar-border: hsl(240 3.7% 15.9%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);

  /* Existing background colors */
  --background-card: #37404c;
  --background-container: #2a313a;
  --background-input: #475263;
  --background-screen: #111111;

  /* Existing border colors */
  --border-container: #64748b;
  --border-divider: #37404c;

  /* New border colors */
  --border-dark: #313131;
  --border-normal: #525252;
  --border-black: #1b1b1b;
  --border-selected-inverse: #f1f1f1;

  /* Existing button colors */
  --button-background-primary: #98d7f9;
  --button-foreground-primary: #0d4766;
  --button-foreground-disabled: #757575;
  --button-background-secondary: #b59eff;
  --button-foreground-secondary: #27136b;

  /* New button colors */
  --button-background-floating: #313131;
  --button-chips: #414141;

  /* Existing text colors (kept for CSS variable references in base styles) */
  --text-muted-title: #d4d4d4;
  --text-user-message: #3f3f3f;

  /* Existing secondary colors */
  --secondary-normal: #b59eff;

  /* Status colors */
  --status-optional: #a1ece7;
  --status-required: #b59eff;
  --status-warning-light: #a16207;
  --status-ready: #0d9488;
}

/* Custom Variants */
@variant has-value (&:not(:placeholder-shown));
@variant no-value (&:placeholder-shown);

/* Custom Animations */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes tab-focus {
  0% {
    opacity: 0;
    border-color: rgba(255, 255, 255, 0);
  }
  50% {
    opacity: 1;
    border-color: rgba(255, 255, 255, 1);
  }
  100% {
    opacity: 0;
    border-color: rgba(255, 255, 255, 0);
  }
}

@keyframes fade-in-up {
  0% {
    opacity: 0;
    transform: translateY(10px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes accordion-down {
  from {
    height: 0;
  }
  to {
    height: var(--radix-accordion-content-height);
  }
}

@keyframes accordion-up {
  from {
    height: var(--radix-accordion-content-height);
  }
  to {
    height: 0;
  }
}

@keyframes typing-dot {
  0%,
  60%,
  100% {
    opacity: 0.3;
    transform: translateY(0) scale(1);
  }
  30% {
    opacity: 1;
    transform: translateY(-4px) scale(1.2);
  }
}

@keyframes pulse-highlight {
  0% {
    box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.6);
  }
  100% {
    box-shadow: 0 0 0 0 transparent;
  }
}

/* Custom Utilities - must be at top level, cannot be nested in @layer */
@utility h-screen-minus-topbar {
  height: calc(100vh - var(--topbar-height));
}

@utility animate-spin {
  animation: spin 1s linear infinite;
}

@utility animate-spin-slow {
  animation: spin 3s linear infinite;
}

@utility animate-tab-focus {
  animation: tab-focus 2s ease-in-out;
}

@utility animate-fade-in-up {
  animation: fade-in-up 0.3s ease-out 0.35s both;
}

@utility animate-accordion-down {
  animation: accordion-down 0.2s ease-out;
}

@utility animate-accordion-up {
  animation: accordion-up 0.2s ease-out;
}

@utility animate-pulse-highlight {
  animation: pulse-highlight 0.8s ease-out;
}

/* Class-based animations for dynamic usage */
.animate-pulse-highlight {
  animation: pulse-highlight 0.8s ease-out;
}

.animate-fade-in-up-dynamic {
  animation: fade-in-up 0.4s ease-out both;
}

.animate-new-item-highlight {
  animation: new-item-highlight 1.2s ease-out;
}

@keyframes new-item-highlight {
  0%, 50% {
    border-color: rgba(34, 197, 94, 0.8);
  }
  25%, 75% {
    border-color: rgba(34, 197, 94, 0.3);
  }
  100% {
    border-color: rgb(82, 82, 82);
  }
}

@keyframes border-pulse {
  0%, 100% {
    border-color: rgba(245, 158, 11, 0.5);
  }
  50% {
    border-color: rgba(245, 158, 11, 0.2);
  }
}

.animate-border-pulse {
  animation: border-pulse 2s ease-in-out infinite;
}

@layer base {
  * {
    border-color: var(--border);
  }
  html {
    height: 100%;
    overscroll-behavior: none;
    touch-action: manipulation;
  }
  body {
    height: 100%;
    min-height: 100dvh;
    color: var(--foreground);
    background-color: var(--color-background-primary);
    font-family:
      var(--font-inter),
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      "Helvetica Neue",
      Arial,
      sans-serif;
  }
  #root {
    height: 100%;
    min-height: 100dvh;
  }

  button:where(:not(:disabled)) {
    cursor: pointer;
  }

  button[aria-disabled="true"] {
    cursor: not-allowed;
  }

  /* Remove textarea resizer */
  textarea.no-resizer::-webkit-resizer {
    display: none;
  }

  textarea {
    scrollbar-color: var(--background-input) transparent;
    resize: none;
  }

  /* Markdown */
  .markdown {
    /* List styles */
    ul {
      list-style-type: disc;
      padding-left: 1.5em;
      margin: 0.5em 0;
    }
    ol {
      list-style-type: decimal;
      padding-left: 1.5em;
      margin: 0.5em 0;
    }
    li {
      margin: 0.25em 0;
    }
    /* Nested lists */
    ul ul {
      list-style-type: circle;
    }
    ul ul ul {
      list-style-type: square;
    }
    /* Horizontal rule */
    hr {
      border: none;
      border-top: 1px solid var(--border-light);
      margin: 1em 0;
    }
  }

  /* Default message styling */
  .ai-chat-style {
    .chat-style-text {
      font-size: 16px;
      color: var(--text-muted-title);
      overflow-x: hidden;
      p + p {
        margin-top: 1em;
      }
    }
    .chat-style-chat-bubble {
      background-color: var(--background-card);
    }
    .message-buttons,
    textarea {
      font-size: 16px;
      color: var(--text-muted-title);
    }
  }
  .user-chat-style {
    .chat-style-text {
      font-size: 16px;
      color: var(--text-user-message);
      overflow-x: hidden;
      p + p {
        margin-top: 1em;
      }
    }
    .chat-style-chat-bubble {
      background-color: var(--background-user-message);
    }
    .message-buttons,
    textarea {
      font-size: 16px;
      color: var(--text-user-message);
    }
  }

  .electron-drag-region {
    -webkit-app-region: drag;
    app-region: drag;
  }

  /* Make sure interactive elements inside drag region are not draggable */
  .electron-drag-region button,
  .electron-drag-region a,
  .electron-drag-region input,
  .electron-drag-region [role="button"] {
    -webkit-app-region: no-drag;
    app-region: no-drag;
  }

  /* iOS Safe Area Utilities */
  .safe-area-top {
    padding-top: var(--safe-area-inset-top);
  }

  /* Disable iOS context menu on images */
  img {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    pointer-events: auto;
  }

  /* Disable iOS context menu on all elements by default */
  * {
    -webkit-touch-callout: none;
  }

  /* Re-enable context menu for interactive elements where it might be needed */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="url"],
  textarea {
    -webkit-touch-callout: default;
    -webkit-user-select: text;
    -khtml-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }

  /* Consolidated Dockview styles */
  .dockview-theme-abyss {
    --dv-separator-border: var(--bg-canvas, #111111) !important;
    --dv-sash-color: var(
      --bg-canvas,
      #111111
    ) !important; /* visible sash color */
    --dv-active-sash-color: var(
      --bg-canvas,
      #111111
    ) !important; /* hover/active color */
  }

  /* Tab containers */
  .dockview-theme-abyss .dv-tab {
    padding: 0 !important;
  }

  /* Tab Coloring */
  /* Maximum specificity override for tab backgrounds and borders */
  .dockview-theme-abyss .dv-groupview .dv-tabs-container .dv-tab {
    background-color: var(--bg-surface, #0a0a0c) !important;
  }

  .dockview-theme-abyss .dv-groupview .dv-tabs-container .dv-tab.dv-active-tab {
    background-color: var(--bg-surface-raised, #141416) !important;
  }

  /* Void container and backgrounds */
  .dockview-theme-abyss .dv-void-container {
    background-color: var(--bg-canvas, #111111) !important;
  }

  /* Prevent Dockview from growing beyond screen size */
  .dv-grid-view.dv-dockview {
    max-height: 100vh !important;
    max-width: 100vw !important;
    overflow: hidden !important;
  }

  /* Prevent variable panels from getting focus */
  [data-panel-id*="variable"] .dv-tab,
  [data-panel-id*="variable"] .dv-tab-content {
    pointer-events: none !important;
  }

  /* Remove Monaco Editor focus border */
  .monaco-editor .monaco-editor-background,
  .monaco-editor .inputarea.ime-input,
  .monaco-editor .margin,
  .monaco-editor {
    outline: none !important;
  }

  /* Remove focus outline from the editor container */
  .monaco-editor-container:focus {
    outline: none !important;
  }

  /* Remove focus outline from textarea elements within Monaco */
  .monaco-editor textarea:focus {
    outline: none !important;
  }

  /* Remove all focus outlines in Monaco Editor */
  .monaco-editor *:focus {
    outline: none !important;
    box-shadow: none !important;
  }

  /* Specific targeting for input areas */
  .monaco-editor .inputarea:focus,
  .monaco-editor .monaco-scrollable-element:focus {
    outline: none !important;
  }

  /* Force editor content to use full width */
  .monaco-editor .overflow-guard {
    width: 100% !important;
  }

  /* Ensure the editor view lines use full width */
  .monaco-editor .view-lines {
    width: 100% !important;
  }

  /* Make sure the editor content expands */
  .monaco-editor .monaco-scrollable-element.editor-scrollable {
    width: 100% !important;
  }

  /* Target the editor's main content area */
  .monaco-editor .monaco-editor-background {
    width: 100% !important;
  }

  /* If you have a specific container class */
  .monaco-editor-container .monaco-editor {
    width: 100% !important;
  }

  /* Remove any right margin that might be reserved for minimap */
  .monaco-editor
    .overflow-guard
    > .monaco-scrollable-element
    > .monaco-editor-background
    > .margin {
    width: 100% !important;
  }

  /* Embla carousel */
  .embla {
    overflow: hidden;
  }
  .embla__container {
    display: flex;
  }
  .embla__slide {
    flex: 0 0 100%;
    min-width: 0;
  }

  /* Subscription nudge carousel */
  .embla-subscription-nudge .embla__slide {
    flex: 0 0 284px;
    min-width: 0;
    min-height: 213px;
  }

  /* Custom session scrollbar with transparent background */
  .session-scrollbar::-webkit-scrollbar {
    width: 8px;
  }

  .session-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .session-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
  }

  .session-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  /* Firefox scrollbar */
  .session-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
  }
}

/* Web version specific overrides */
.web-version {
  --topbar-height: 0px !important; /* No topbar in web browser */
}

/* Also set on root when body has web-version class */
:root:has(body.web-version) {
  --topbar-height: 0px !important;
}

/* Global scrollbar styles - applied to all scrollable elements */
*::-webkit-scrollbar {
  width: 0.5rem; /* w-2 */
}

*::-webkit-scrollbar-track {
  background-color: transparent;
}

*::-webkit-scrollbar-thumb {
  border-radius: 0.25rem; /* rounded */
  background-color: rgb(255 255 255 / 0.5); /* bg-white/50 */
}

/* chat message list scrollbar */
.custom-scrollbar {
  overflow-y: scroll;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 8px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(255, 255, 255, 0.15);
  border-radius: 4px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: rgba(255, 255, 255, 0.3);
}
